
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>porcupine.pluginloader — The module that loads plugins on startup &#8212; Porcupine API 0.76.2-git-cc31e29 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="porcupine.utils — Handy utility functions and classes" href="utils.html" />
    <link rel="prev" title="porcupine.settings — Porcupine’s setting manager" href="settings.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-porcupine.pluginloader">
<span id="porcupine-pluginloader-the-module-that-loads-plugins-on-startup"></span><h1><a class="reference internal" href="#module-porcupine.pluginloader" title="porcupine.pluginloader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.pluginloader</span></code></a> — The module that loads plugins on startup<a class="headerlink" href="#module-porcupine.pluginloader" title="Permalink to this headline">¶</a></h1>
<p>On startup, Porcupine loads plugins roughly like this (after calling
<a class="reference internal" href="porcupine.html#porcupine.init" title="porcupine.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">porcupine.init()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">porcupine</span> <span class="kn">import</span> <span class="n">pluginloader</span>
<span class="n">pluginloader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/Akuli/porcupine/tree/master/porcupine/__main__.py">The real code</a> is a little more complicated
than that because the behaviour can be changed with command-line arguments, but
you get the idea.</p>
<p>In this documentation, a plugin name means no file extension or
<code class="docutils literal notranslate"><span class="pre">porcupine.plugins.</span></code> prefix, e.g. <code class="docutils literal notranslate"><span class="pre">highlight</span></code> instead of <code class="docutils literal notranslate"><span class="pre">highlight.py</span></code>
or <code class="docutils literal notranslate"><span class="pre">porcupine.plugins.highlight</span></code>.</p>
<dl class="py class">
<dt id="porcupine.pluginloader.Status">
<em class="property">class </em><code class="sig-prename descclassname">porcupine.pluginloader.</code><code class="sig-name descname">Status</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/porcupine/pluginloader.html#Status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#porcupine.pluginloader.Status" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference external" href="https://docs.python.org/3/library/enum.html#module-enum" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Enum</span></code></a> represents the status of the plugin in the
currently running Porcupine process.</p>
<dl class="py data">
<dt id="porcupine.pluginloader.Status.LOADING">
<code class="sig-name descname">LOADING</code><a class="headerlink" href="#porcupine.pluginloader.Status.LOADING" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#porcupine.pluginloader.load" title="porcupine.pluginloader.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> function is currently running, and it doesn’t know yet
what the final status of the plugin will be.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.ACTIVE">
<code class="sig-name descname">ACTIVE</code><a class="headerlink" href="#porcupine.pluginloader.Status.ACTIVE" title="Permalink to this definition">¶</a></dt>
<dd><p>The plugin was imported and its <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function was called successfully.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.DISABLED_BY_SETTINGS">
<code class="sig-name descname">DISABLED_BY_SETTINGS</code><a class="headerlink" href="#porcupine.pluginloader.Status.DISABLED_BY_SETTINGS" title="Permalink to this definition">¶</a></dt>
<dd><p>The plugin wasn’t loaded because it’s in the <code class="docutils literal notranslate"><span class="pre">disabled_plugins</span></code>
setting. See <a class="reference internal" href="settings.html#module-porcupine.settings" title="porcupine.settings"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.settings</span></code></a>.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.DISABLED_ON_COMMAND_LINE">
<code class="sig-name descname">DISABLED_ON_COMMAND_LINE</code><a class="headerlink" href="#porcupine.pluginloader.Status.DISABLED_ON_COMMAND_LINE" title="Permalink to this definition">¶</a></dt>
<dd><p>The plugin wasn’t loaded because it was listed in a
<code class="docutils literal notranslate"><span class="pre">--without-plugins</span></code> argument given to Porcupine.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.IMPORT_FAILED">
<code class="sig-name descname">IMPORT_FAILED</code><a class="headerlink" href="#porcupine.pluginloader.Status.IMPORT_FAILED" title="Permalink to this definition">¶</a></dt>
<dd><p>Importing the plugin raised an error.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.SETUP_FAILED">
<code class="sig-name descname">SETUP_FAILED</code><a class="headerlink" href="#porcupine.pluginloader.Status.SETUP_FAILED" title="Permalink to this definition">¶</a></dt>
<dd><p>The plugin was imported successfully, but calling its <code class="docutils literal notranslate"><span class="pre">setup()</span></code>
function raised an error.</p>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.Status.CIRCULAR_DEPENDENCY_ERROR">
<code class="sig-name descname">CIRCULAR_DEPENDENCY_ERROR</code><a class="headerlink" href="#porcupine.pluginloader.Status.CIRCULAR_DEPENDENCY_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>Plugins with this status were imported, but their <code class="docutils literal notranslate"><span class="pre">setup_before</span></code> and
<code class="docutils literal notranslate"><span class="pre">setup_after</span></code> lists make it impossible to determine the correct order
for calling their <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function. For example, if plugin <em>A</em>
should be set up before <em>B</em>, <em>B</em> should be set up before <em>C</em> and <em>C</em>
should be set up before <em>A</em>, then <em>A</em>, <em>B</em> and <em>C</em> will all fail with
<code class="docutils literal notranslate"><span class="pre">CIRCULAR_DEPENDENCY_ERROR</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="porcupine.pluginloader.PluginInfo">
<em class="property">class </em><code class="sig-prename descclassname">porcupine.pluginloader.</code><code class="sig-name descname">PluginInfo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a></span></em>, <em class="sig-param"><span class="n">came_with_porcupine</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></span></em>, <em class="sig-param"><span class="n">status</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#porcupine.pluginloader.Status" title="porcupine.pluginloader.Status">porcupine.pluginloader.Status</a></span></em>, <em class="sig-param"><span class="n">module</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Any<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">setup_before</span><span class="p">:</span> <span class="n">Set<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">setup_after</span><span class="p">:</span> <span class="n">Set<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">error</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/porcupine/pluginloader.html#PluginInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#porcupine.pluginloader.PluginInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dataclass</span></code></a> represents a plugin.</p>
<p>It’s usually better to use <code class="docutils literal notranslate"><span class="pre">info.setup_before</span></code>
instead of accessing <code class="docutils literal notranslate"><span class="pre">info.module.setup_before</span></code> directly.
Not all plugins define a <code class="docutils literal notranslate"><span class="pre">setup_before</span></code> variable, and if it’s not present,
then <code class="docutils literal notranslate"><span class="pre">info.setup_before</span></code> is an empty set.
This also applies to <code class="docutils literal notranslate"><span class="pre">setup_after</span></code>.</p>
<p>The value of <em>error</em> depends on <em>status</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>If <em>status</em> is <code class="docutils literal notranslate"><span class="pre">LOADING</span></code>, <code class="docutils literal notranslate"><span class="pre">ACTIVE</span></code>, <code class="docutils literal notranslate"><span class="pre">DISABLED_BY_SETTINGS</span></code> or
<code class="docutils literal notranslate"><span class="pre">DISABLED_ON_COMMAND_LINE</span></code>, then <em>error</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p>If <em>status</em> is <code class="docutils literal notranslate"><span class="pre">IMPORT_FAILED</span></code> or <code class="docutils literal notranslate"><span class="pre">SETUP_FAILED</span></code>, then <em>error</em>
is a Python error message, starting with
<code class="docutils literal notranslate"><span class="pre">Traceback</span> <span class="pre">(most</span> <span class="pre">recent</span> <span class="pre">call</span> <span class="pre">last):</span></code>.</p></li>
<li><p>If <em>status</em> is <code class="docutils literal notranslate"><span class="pre">CIRCULAR_DEPENDENCY_ERROR</span></code>, then <em>error</em> is a
user-readable one-line message.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py data">
<dt id="porcupine.pluginloader.plugin_infos">
<code class="sig-prename descclassname">porcupine.pluginloader.</code><code class="sig-name descname">plugin_infos</code><em class="property">: Sequence<span class="p">[</span>PluginInfo<span class="p">]</span></em><a class="headerlink" href="#porcupine.pluginloader.plugin_infos" title="Permalink to this definition">¶</a></dt>
<dd><p>This contains infos for all the plugins that the plugin loader knows about,
including plugins that failed to load and disabled plugins.</p>
</dd></dl>

<dl class="py function">
<dt id="porcupine.pluginloader.load">
<code class="sig-prename descclassname">porcupine.pluginloader.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">disabled_on_command_line</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">[]</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)">None</a><a class="reference internal" href="_modules/porcupine/pluginloader.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#porcupine.pluginloader.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load plugins.</p>
<p>The plugins are always ordered using their <code class="docutils literal notranslate"><span class="pre">setup_before</span></code> and
<code class="docutils literal notranslate"><span class="pre">setup_after</span></code> lists. The <em>shuffle</em> argument determines what is
done when multiple plugins can be loaded in any order with respect
to each other. By default, they are sorted alphabetically, so
things like menu items are always in the same order. Setting
<code class="docutils literal notranslate"><span class="pre">shuffle=True</span></code> means that a random order is used instead; this is
useful for making sure that the plugins don’t rely on the sorting.</p>
<p>Plugins specified as <em>disabled_on_command_line</em> won’t be loaded.</p>
<p>Exceptions are caught and logged, so there’s no need to wrap calls to this
function in <code class="docutils literal notranslate"><span class="pre">try,except</span></code>.</p>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Porcupine API</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plugin-intro.html">Introduction to Writing Plugins</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="porcupine.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine</span></code> — The top level Porcupine package</a></li>
<li class="toctree-l1"><a class="reference internal" href="menubar.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.menubar</span></code> — The menu bar at the top of the Porcupine window</a></li>
<li class="toctree-l1"><a class="reference internal" href="tabs.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.tabs</span></code> — The tab manager and tabs in it</a></li>
<li class="toctree-l1"><a class="reference internal" href="textwidget.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.textwidget</span></code> — Things for <code class="docutils literal notranslate"><span class="pre">tkinter.Text</span></code> widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="images.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.images</span></code> — Load images that come with Porcupine</a></li>
<li class="toctree-l1"><a class="reference internal" href="dirs.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.dirs</span></code> — Paths to Porcupine’s files</a></li>
<li class="toctree-l1"><a class="reference internal" href="filetypes.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.filetypes</span></code> — Low-level access to <code class="docutils literal notranslate"><span class="pre">filetypes.toml</span></code> stuff</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.settings</span></code> — Porcupine’s setting manager</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.pluginloader</span></code> — The module that loads plugins on startup</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.utils</span></code> — Handy utility functions and classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="settings.html" title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.settings</span></code> — Porcupine’s setting manager</a></li>
      <li>Next: <a href="utils.html" title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">porcupine.utils</span></code> — Handy utility functions and classes</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Akuli.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/pluginloader.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>